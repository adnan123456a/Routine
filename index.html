<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>30-Day Study Plan Tracker</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #121212 0%, #1a1a1a 100%);
            color: #ffffff;
            font-family: 'Segoe UI', sans-serif;
            min-height: 100vh;
        }
        .container {
            max-width: 900px;
            margin-top: 40px;
            padding: 30px;
            background: #1e1e1e;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.5);
        }
        #quote {
            font-style: italic;
            color: #ffffff;
            margin-bottom: 25px;
            padding: 20px;
            background: #2c2c2c;
            border-radius: 10px;
            border-left: 5px solid #0d6efd;
            transition: transform 0.3s ease;
        }
        #quote:hover {
            transform: translateY(-5px);
        }
        .task-item {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        .task-item input {
            margin-right: 12px;
        }
        .list-group-item {
            background-color: #2c2c2c;
            color: #ffffff;
            border: 1px solid #444;
            border-radius: 8px;
            transition: background-color 0.3s;
        }
        .list-group-item:hover {
            background-color: #373737;
        }
        .btn-primary {
            background: linear-gradient(45deg, #0d6efd, #6610f2);
            border: none;
            transition: transform 0.2s;
        }
        .btn-primary:hover {
            transform: scale(1.05);
        }
        .btn-success {
            background: linear-gradient(45deg, #198754, #20c997);
            border: none;
        }
        .btn-secondary {
            background: #444;
            border: none;
        }
        .progress {
            background-color: #333;
            border-radius: 10px;
        }
        .progress-bar {
            background: linear-gradient(45deg, #0d6efd, #6610f2);
        }
        .alert {
            background-color: #2c2c2c;
            color: #ffffff;
            border: 1px solid #444;
            border-radius: 8px;
        }
        .modal-content {
            background: #1e1e1e;
            color: #ffffff;
            border-radius: 12px;
        }
        .modal-header, .modal-footer {
            border-color: #444;
        }
        .form-control, .form-select {
            background-color: #2c2c2c;
            color: #ffffff;
            border: 1px solid #444;
            border-radius: 8px;
        }
        .form-control:focus, .form-select:focus {
            background-color: #2c2c2c;
            color: #ffffff;
            border-color: #0d6efd;
            box-shadow: 0 0 8px rgba(13, 110, 253, 0.5);
        }
        .form-text {
            color: #ffffff;
        }
        .notification-alert {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
        .history-item {
            padding: 10px;
            margin-bottom: 10px;
            background: #2c2c2c;
            color: #ffffff;
            border-radius: 8px;
        }
        .card {
            background: #2c2c2c;
            border: 1px solid #444;
            border-radius: 10px;
            transition: transform 0.3s;
        }
        .card:hover {
            transform: translateY(-5px);
        }
        .card-title, .modal-title, .text-muted {
            color: #ffffff;
        }
        label {
            color: white;
        }
        p {
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-center mb-4" style="font-weight: 700; text-shadow: 0 2px 4px rgba(0,0,0,0.3);">30-Day Study Plan Tracker</h1>
        <div id="quote" class="rounded"></div>
        <div class="card mb-4">
            <div class="card-body">
                <h2 class="card-title">Tasks <i class="bi bi-list-task"></i></h2>
                <ul id="task-list" class="list-group"></ul>
                <button id="add-task-btn" class="btn btn-primary mt-3" data-bs-toggle="modal" data-bs-target="#addTaskModal"><i class="bi bi-plus-circle"></i> Add New Task</button>
            </div>
        </div>
        <div class="card mb-4">
            <div class="card-body">
                <h2 class="card-title">Progress for Day <span id="current-day"></span> <i class="bi bi-bar-chart"></i></h2>
                <div class="progress mb-3" id="daily-progress-bar">
                    <div class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
                </div>
                <div id="checkboxes"></div>
                <div id="streak-info" class="mt-3 alert alert-info"></div>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                <h2 class="card-title">Completion History <i class="bi bi-clock-history"></i></h2>
                <div id="history"></div>
            </div>
        </div>
    </div>

    <!-- Add Task Modal -->
    <div class="modal fade" id="addTaskModal" tabindex="-1" aria-labelledby="addTaskModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addTaskModalLabel">Add New Task</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <input type="text" id="new-task-input" class="form-control" placeholder="Enter task name">
                    <input type="number" id="task-duration" class="form-control mt-2" placeholder="Duration (days)" min="1" max="30">
                    <input type="file" id="task-file-input" class="form-control mt-2" accept=".txt,.pdf,.jpg,.png">
                    <small class="form-text">Optional: Upload a file (stored locally as base64). Set duration for task completion.</small>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" id="save-task-btn" class="btn btn-primary">Save Task</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const quotes = [
            {text: "The man who does not read books has no advantage over the one who cannot read them.", author: "Mark Twain"},
            {text: "Education is the passport to the future, for tomorrow belongs to those who prepare for it today.", author: "Malcolm X"},
            {text: "Teachers can open the door, but you must enter it yourself.", author: "Chinese proverb"},
            {text: "The beautiful thing about learning is that no one can take it away from you.", author: "B.B. King"},
            {text: "Education is the most powerful weapon you can use to change the world.", author: "B.B. King"},
            {text: "The mind is not a vessel to be filled but a fire to be ignited.", author: "Plutarch"},
            {text: "Don’t let what you cannot do interfere with what you can do.", author: "John Wooden"},
            {text: "A person who never made a mistake never tried anything new.", author: "Albert Einstein"},
            {text: "Failure isn’t final. In fact, it can be a powerful tool for growth and progress.", author: "Anonymous"},
            {text: "Never let the fear of striking out stop you from playing the game.", author: "Babe Ruth"},
            {text: "Procrastination makes easy things hard and hard things harder.", author: "Mason Cooley"},
            {text: "You don’t have to be great to start, but you have to start to be great.", author: "Zig Ziglar"},
            {text: "The expert in anything was once a beginner.", author: "Helen Hayes"},
            {text: "The way to get started is to quit talking and begin doing.", author: "Walt Disney"},
            {text: "There are no shortcuts to any place worth going.", author: "Beverly Stills"},
            {text: "I think it’s possible for ordinary people to choose to be extraordinary.", author: "Elon Musk"},
            {text: "I find that the harder I work, the more luck I seem to have.", author: "Thomas Jefferson"},
            {text: "Genius is 10% inspiration, 90% perspiration.", author: "Thomas Edison"},
            {text: "Motivation is what gets you started. Habit is what keeps you going.", author: "Jim Ryun"},
            {text: "Success is the sum of small efforts, repeated.", author: "R. Collier"},
            {text: "The best way to predict your future is to create it.", author: "Abraham Lincoln"},
            {text: "The future belongs to those who believe in the beauty of their dreams.", author: "Eleanor Roosevelt"},
            {text: "You are braver than you believe, stronger than you seem and smarter than you think.", author: "A.A. Milne"},
            {text: "Learn from yesterday. Live for today. Hope for tomorrow.", author: "Albert Einstein"},
            {text: "The more that you read, the more things you will know, the more that you learn, the more places you’ll go.", author: "Dr. Seuss"},
            {text: "Today a reader. Tomorrow a leader.", author: "Anonymous"},
            {text: "In a world where you can be anything, be kind.", author: "Jennifer Dukes Lee"},
            {text: "None of us is as smart as all of us.", author: "Ken Blanchard"},
            {text: "He who asks a question is a fool for five minutes; he who does not ask a question remains a fool forever.", author: "Chinese proverb"},
            {text: "You have to be odd to be No.1.", author: "Dr. Seuss"}
        ];

        let startDate = localStorage.getItem('startDate') ? new Date(localStorage.getItem('startDate')) : new Date();
        let tasks = JSON.parse(localStorage.getItem('tasks')) || ["Chemistry Chapter 2", "Biology Chapter 1", "Physics Chapter 2"];
        let progress = JSON.parse(localStorage.getItem('progress')) || {};
        let files = JSON.parse(localStorage.getItem('files')) || {};
        let durations = JSON.parse(localStorage.getItem('durations')) || {};
        let completedTasks = JSON.parse(localStorage.getItem('completedTasks')) || [];

        // Initialize storage
        if (!localStorage.getItem('startDate')) {
            localStorage.setItem('startDate', startDate.toISOString());
        }
        tasks.forEach(task => {
            if (!progress[task]) {
                progress[task] = Array(30).fill(false);
            }
            if (!files[task]) {
                files[task] = null;
            }
            if (!durations[task]) {
                durations[task] = 3;
            }
        });

        function getCurrentDay() {
            const today = new Date();
            const diffTime = today - startDate;
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24)) + 1;
            return Math.min(Math.max(diffDays, 1), 30);
        }

        const currentDay = getCurrentDay();
        document.getElementById('current-day').textContent = currentDay;

        // Display random quote
        function displayRandomQuote() {
            const quoteDiv = document.getElementById('quote');
            const randomIndex = Math.floor(Math.random() * quotes.length);
            const quote = quotes[randomIndex];
            quoteDiv.innerHTML = `"${quote.text}" — ${quote.author}`;
        }

        displayRandomQuote();

        // Render tasks
        function renderTasks() {
            const taskList = document.getElementById('task-list');
            taskList.innerHTML = '';
            tasks.forEach(task => {
                const li = document.createElement('li');
                li.className = 'list-group-item d-flex justify-content-between align-items-center';
                li.innerHTML = `${task} <small class="text-muted">(${durations[task]} days)</small>`;
                if (files[task]) {
                    const downloadBtn = document.createElement('a');
                    downloadBtn.href = files[task];
                    downloadBtn.download = `${task}_file`;
                    downloadBtn.className = 'btn btn-sm btn-secondary ms-2';
                    downloadBtn.innerHTML = '<i class="bi bi-download"></i>';
                    li.appendChild(downloadBtn);
                }
                taskList.appendChild(li);
            });
        }

        // Render checkboxes and progress
        function renderCheckboxes(day) {
            const checkboxesDiv = document.getElementById('checkboxes');
            checkboxesDiv.innerHTML = '';
            let completedCount = 0;
            tasks.forEach(task => {
                const div = document.createElement('div');
                div.className = 'task-item';
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.checked = progress[task][day - 1];
                if (checkbox.checked) completedCount++;
                checkbox.addEventListener('change', () => {
                    progress[task][day - 1] = checkbox.checked;
                    localStorage.setItem('progress', JSON.stringify(progress));
                    if (checkbox.checked) {
                        checkTaskCompletion(task, day);
                    }
                    renderCheckboxes(day);
                    checkAllCompleted(day);
                });
                const label = document.createElement('label');
                label.textContent = task;
                div.appendChild(checkbox);
                div.appendChild(label);
                checkboxesDiv.appendChild(div);
            });
            const progressPercentage = tasks.length ? (completedCount / tasks.length) * 100 : 0;
            const progressBar = document.getElementById('daily-progress-bar').querySelector('.progress-bar');
            progressBar.style.width = `${progressPercentage}%`;
            progressBar.textContent = `${Math.round(progressPercentage)}%`;
            progressBar.setAttribute('aria-valuenow', progressPercentage);
            displayRandomQuote();
            renderStreak();
            renderHistory();
        }

        // Check if task is completed within duration
        function checkTaskCompletion(task, day) {
            const duration = durations[task];
            const startDay = Math.max(1, day - duration + 1);
            const completedInDuration = progress[task].slice(startDay - 1, day).some(completed => completed);
            if (completedInDuration && !completedTasks.includes(task)) {
                completedTasks.push(task);
                localStorage.setItem('completedTasks', JSON.stringify(completedTasks));
            }
        }

        // Check if all tasks completed for the day
        function checkAllCompleted(day) {
            const allCompleted = tasks.every(task => progress[task][day - 1]);
            if (allCompleted && tasks.length >= 3) {
                const addModal = new bootstrap.Modal(document.getElementById('addTaskModal'));
                addModal.show();
            }
        }

        // Render streak
        function renderStreak() {
            let streak = 0;
            for (let d = currentDay; d >= 1; d--) {
                const allCompleted = tasks.every(task => progress[task][d - 1]);
                if (allCompleted) {
                    streak++;
                } else {
                    break;
                }
            }
            const streakInfo = document.getElementById('streak-info');
            streakInfo.innerHTML = `Current Streak: ${streak} days <i class="bi bi-fire"></i>`;
        }

        // Render completion history
        function renderHistory() {
            const historyDiv = document.getElementById('history');
            historyDiv.innerHTML = '';
            completedTasks.forEach(task => {
                const div = document.createElement('div');
                div.className = 'history-item';
                div.innerHTML = `Completed: ${task} <small class="text-muted">(within ${durations[task]} days)</small>`;
                historyDiv.appendChild(div);
            });
            if (!completedTasks.length) {
                historyDiv.innerHTML = '<p class="text-muted">No tasks completed yet.</p>';
            }
        }

        // Add task with duration and file
        const newTaskInput = document.getElementById('new-task-input');
        const taskDuration = document.getElementById('task-duration');
        const taskFileInput = document.getElementById('task-file-input');
        const saveTaskBtn = document.getElementById('save-task-btn');

        saveTaskBtn.addEventListener('click', () => {
            const newTask = newTaskInput.value.trim();
            const duration = parseInt(taskDuration.value) || 3;
            if (newTask) {
                tasks.push(newTask);
                progress[newTask] = Array(30).fill(false);
                durations[newTask] = Math.min(Math.max(duration, 1), 30);
                if (taskFileInput.files.length > 0) {
                    const file = taskFileInput.files[0];
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        files[newTask] = e.target.result;
                        localStorage.setItem('files', JSON.stringify(files));
                        finalizeAddTask();
                    };
                    reader.readAsDataURL(file);
                } else {
                    files[newTask] = null;
                    finalizeAddTask();
                }
            }
        });

        function finalizeAddTask() {
            localStorage.setItem('tasks', JSON.stringify(tasks));
            localStorage.setItem('progress', JSON.stringify(progress));
            localStorage.setItem('durations', JSON.stringify(durations));
            renderTasks();
            renderCheckboxes(currentDay);
            newTaskInput.value = '';
            taskDuration.value = '';
            taskFileInput.value = '';
            bootstrap.Modal.getInstance(document.getElementById('addTaskModal')).hide();
        }

        // Check for notifications
        function checkNotifications() {
            if (!("Notification" in window)) return;

            Notification.requestPermission().then(permission => {
                if (permission === "granted") {
                    const day = currentDay;
                    tasks.forEach(task => {
                        const duration = durations[task];
                        if (day > duration) {
                            const lastDays = progress[task].slice(day - duration - 1, day - 1);
                            if (lastDays.every(completed => !completed)) {
                                new Notification(`Reminder: Complete ${task}!`, {
                                    body: `You haven't completed ${task} in the last ${duration} days. Time to catch up!`
                                });
                            }
                        }
                    });
                }
            });
        }

        // Initial render
        renderTasks();
        renderCheckboxes(currentDay);
        checkNotifications();
    </script>
</body>
</html>